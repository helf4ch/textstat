# Краткое описание
Backend на Java с использованием Spring Boot для анализа текста с использованием OpenNLP.

# Запуск
Для запуска необходима версия Java 21+.
Клонируйте репозиторий, перейдите в корневую папаку и выполните команду:
```
.\mvnw.cmd spring-boot:run
```
или (Unix)
```
./mvnw spring-boot:run
```

Для запуска тестов:
```
.\mvnw.cmd test
```

# Описание проекта
Проект имеет следующую структуру:
- src/main/java/com/github/helf4ch/textstat:
  - controller/DocumentController - сервис, который предоставляет API
  - model - классы-таблицы из базы данных
  - repository - репозитории, предаставляющие доступ к базе данных
  - nlp - все, что связанно с OpenNLP
- src/main/resources/models - содержит модели OpenNLP

Сервис использует OpenNLP для токенеизации и детектирования предложений. Получая на вход текст, с помощью OpenNLP Language Detection определяется язык текста, после чего применяется нужная языковая модель для Tokenization и SentenceDetection. Таким обзразом, **достигается наивысшая точность в разбиении текста на токены (слова, знаки препинания) и на предложения**. После токенеизации текст нормализуется. Используя нормализованный текст и массив строк, который содержит предложения в тексте, считается статистика текста.

[NlpProvider](https://github.com/helf4ch/textstat/blob/master/src/main/java/com/github/helf4ch/textstat/nlp/NlpProvider.java) является основным классом, предоставляющим такие фукнции. Он инкапсулирует в себе языковые модели.

[LanguageConfigurator](https://github.com/helf4ch/textstat/blob/master/src/main/java/com/github/helf4ch/textstat/nlp/LanguageConfigurator.java) отвечает за то, какой обработчик текста будет использован для конкретного языка. Он поддерживает добавление как одного языка, так и семейства языков (схожих языков, которые могут использовать одну языковую модель: например, украинский и белорусский языки).

Сейчас добавлено только 3 языковые модели: английский, русский, украинский. Чтобы добавить новую языковую модель: [скачать ее](https://opennlp.apache.org/models.html) (или обучить), поместить в resources/models/<тип языковой модели>, наследоваться от класса LangProvider [(пример)](https://github.com/helf4ch/textstat/blob/master/src/main/java/com/github/helf4ch/textstat/nlp/models/lang/EngProvider.java), указать обработчик текста для языка в NlpProvider [(пример)](src/main/java/com/github/helf4ch/textstat/nlp/NlpProvider.java).

Для того, чтобы правильно нормализовать текст, в таблице stop_tokens должны содержаться все нужные стоп слова, а так же знаки пунктуации, и вообще любые токены, которые не должны находится в тексте.

# Будущее проекта
Мне бы хотелось:
- добавить все доступные языковые модели
- объединить все похожие языки в семейства, тем самым повышая список поддерживаемых языков
- добавить больше тестов
- поменять то, как добавляются стоп слова (загружать их в бд при старте/загружать только те, которых нет)
- мигрировать на postgresql (все запросы совместимы)
- добавить контейнеризацию (docker)
- реализовать большее количество функций API и собирать больше статистики

# Описание API
Проект имеет следующее API:
- POST /api/documents - добавление документов. В теле запроса должен быть json формата:
```
{text: "Пример текста. Пример биграмм: слово, слово, слово."}
```
- GET /api/documents/{id} - получение документа по id
```
{
    "id": 1,
    "text": "Пример текста. Пример биграмм: слово, слово, слово."
}
```
- GET /api/documents/{id}/normalized - получение нормализованного текста
```
{
    "id": 1,
    "text": "пример текста пример биграмм слово слово слово"
}
```
- GET /api/documents/{id}/statistics - получение различной статистики текста
```
{
    "word_count": 12,
    "uniq_word_count": 4,
    "avg_word_lenght": 5,
    "sentences_count": 2
}
```
- GET /api/documents/{id}/top-words - получение списка слов, отсортированных по упоминанию в текста. Имеет параметр limit, задающий количество выдаваемых слов (по умолчанию равен 10)
```
{
    "слово": 3,
    "пример": 2,
    "биграмм": 1,
    "текста": 1
}
```
- GET /api/documents/{id}/bigrams - получение списка биграмм в тексте
```
{
    "слово": 3,
    "пример": 2
}
```
- GET /api/documents/statistics - получение различной статистики всех текстов
```
{
    "documents_count": 1,
    "word_count": 12,
    "uniq_word_count": 4,
    "avg_word_lenght": 5,
    "sentences_count": 2
}
```
- GET /api/documents/top-words - получение списка самых упоминаемых слов во всех текстах. Имеет параметр limit, задающий количество выдаваемых слов (по умолчанию равен 10)
- GET /api/documents/search?word=пример - получение списка id текстов, где слово word упоминается
```
[
    1
]
```
